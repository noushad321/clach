(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["module-wishlist-trigger"],{

/***/ "./cartridges/app_accelerator_core/cartridge/client/default/js/modules/module.wishlist-trigger.js":
/*!********************************************************************************************************!*\
  !*** ./cartridges/app_accelerator_core/cartridge/client/default/js/modules/module.wishlist-trigger.js ***!
  \********************************************************************************************************/
/*! exports provided: init */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"init\", function() { return init; });\n/* harmony import */ var _components_progress__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/progress */ \"./cartridges/app_accelerator_core/cartridge/client/default/js/components/progress.js\");\n/* harmony import */ var _helpers_modules__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/modules */ \"./cartridges/app_staffsales_core/cartridge/client/default/js/helpers/modules.js\");\n/* harmony import */ var _borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @borngroup/born-utilities */ \"./node_modules/@borngroup/born-utilities/dist/born-utilities.min.js\");\n/* harmony import */ var _borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _wishlist_wishlistUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../wishlist/wishlistUtils */ \"./cartridges/app_accelerator_core/cartridge/client/default/js/wishlist/wishlistUtils.js\");\n\n\n\n\n\n\n/**\n * appends params to a url\n * @param {string} data - data returned from the server's ajax call\n * @param {Object} icon - icon that was clicked to add a product to the wishlist\n */\n\nfunction _handleWishlistResponse(response) {\n  if (response.success) {\n    Object(_wishlist_wishlistUtils__WEBPACK_IMPORTED_MODULE_3__[\"updateTriggersByID\"])(response.pid, response.type === 'remove', response.listIsEmpty);\n\n    if (response.type !== 'remove') {\n      _helpers_modules__WEBPACK_IMPORTED_MODULE_1__[\"default\"].tracking.init(null, {\n        trackEvent: 'add_to_wishlist',\n        trackObject: {\n          asyncParams: {\n            pid: response.pid\n          }\n        }\n      });\n    }\n  } else if (response.inWishlist) {\n    //If `success`` is false, and the item is already in the wishlist, update the trigger to reflect that.\n    Object(_wishlist_wishlistUtils__WEBPACK_IMPORTED_MODULE_3__[\"updateTriggersByID\"])(response.pid);\n  }\n\n  _components_progress__WEBPACK_IMPORTED_MODULE_0__[\"hideLoader\"]();\n}\n/**\n * Requests a Wishlist endpoint call to the server.\n */\n\n\nfunction _wishlistRequest(url, pid) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var useGET = arguments.length > 3 ? arguments[3] : undefined;\n  $.ajax({\n    url: url,\n    type: useGET ? 'GET' : 'POST',\n    dataType: 'json',\n    data: {\n      pid: pid,\n      optionId: options.optionId,\n      optionVal: options.selectedValueId\n    },\n    success: _handleWishlistResponse,\n    error: _handleWishlistResponse\n  });\n}\n/**\n * Handles an event (typically a click) on a `wishlist-trigger` element.\n * @param  {[type]} evt [description]\n * @return {[type]}     [description]\n */\n\n\nfunction _handleWishlistTrigger(evt) {\n  var triggerData = Object(_wishlist_wishlistUtils__WEBPACK_IMPORTED_MODULE_3__[\"getTriggerData\"])(this),\n      url = triggerData.isRemove ? window.SFRA.Urls.wishlistRemoveProduct : window.SFRA.Urls.wishlistAddProduct;\n  evt.preventDefault();\n\n  if (!url || !triggerData.pid) {\n    return;\n  }\n\n  _components_progress__WEBPACK_IMPORTED_MODULE_0__[\"showLoader\"](this);\n\n  _wishlistRequest(url, triggerData.pid, triggerData.options, triggerData.isRemove);\n}\n/**\n * Handles the response for the `InWishlist` endpoint request.\n * @param  {[type]} response [description]\n * @return {[type]}          [description]\n */\n\n\nfunction _handleInWishlistCheckResponse(response) {\n  if (response.success) {\n    response.itemsInList.forEach(function (currentID) {\n      return Object(_wishlist_wishlistUtils__WEBPACK_IMPORTED_MODULE_3__[\"updateTriggersByID\"])(currentID);\n    });\n  }\n}\n/**\n * Uses `itemList` to request a server check on the items that are already part of the current user's wishlist.\n * @param  {[type]} itemList [description]\n * @return {[type]}          [description]\n */\n\n\nfunction _requestInWishlistCheck(itemList) {\n  return $.ajax({\n    url: window.SFRA.Urls.wishlistInList,\n    type: 'POST',\n    dataType: 'json',\n    data: {\n      itemList: JSON.stringify(itemList)\n    },\n    success: _handleInWishlistCheckResponse\n  });\n}\n/**\n * Initializes `wishlist-trigger` elements.\n * @param  {[type]} options [description]\n * @return {[type]}         [description]\n */\n\n\nfunction setupWishlistTriggers(options) {\n  var existInWishlist = [];\n  Object(_borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_2__[\"callbackOnElements\"])(options.elements, function (currentTrigger) {\n    var triggerType = Object(_wishlist_wishlistUtils__WEBPACK_IMPORTED_MODULE_3__[\"getTriggerType\"])(currentTrigger);\n    existInWishlist.push(Object(_wishlist_wishlistUtils__WEBPACK_IMPORTED_MODULE_3__[\"getTriggerData\"])(currentTrigger));\n    currentTrigger.removeAttribute('data-wishlist-trigger');\n    currentTrigger.setAttribute('data-wishlist-trigger-ready', triggerType);\n    currentTrigger.addEventListener('click', _handleWishlistTrigger);\n  });\n  return _requestInWishlistCheck(existInWishlist);\n}\n\nvar init = setupWishlistTriggers;\n\n//# sourceURL=webpack:///./cartridges/app_accelerator_core/cartridge/client/default/js/modules/module.wishlist-trigger.js?");

/***/ }),

/***/ "./cartridges/app_accelerator_core/cartridge/client/default/js/wishlist/wishlistUtils.js":
/*!***********************************************************************************************!*\
  !*** ./cartridges/app_accelerator_core/cartridge/client/default/js/wishlist/wishlistUtils.js ***!
  \***********************************************************************************************/
/*! exports provided: getTriggerType, updateTriggersByID, updateTriggerState, getTriggerData, updateWishlistTriggers */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTriggerType\", function() { return getTriggerType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateTriggersByID\", function() { return updateTriggersByID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateTriggerState\", function() { return updateTriggerState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTriggerData\", function() { return getTriggerData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateWishlistTriggers\", function() { return updateWishlistTriggers; });\n/* harmony import */ var _borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @borngroup/born-utilities */ \"./node_modules/@borngroup/born-utilities/dist/born-utilities.min.js\");\n/* harmony import */ var _borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _product_productUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../product/productUtils */ \"./cartridges/app_accelerator_core/cartridge/client/default/js/product/productUtils.js\");\n\n\n\n\nfunction getTriggerType(triggerEl) {\n  return triggerEl.getAttribute('data-wishlist-trigger') || triggerEl.getAttribute('data-wishlist-trigger-ready') || 'cta';\n}\n/**\n * Multiple items with the same ID might exist on the same page, ensure they're all accounted for.\n * @param  {[type]}  currentID [description]\n * @param  {Boolean} isRemove  [description]\n * @return {[type]}            [description]\n */\n\nfunction updateTriggersByID(currentID, isRemove, listIsEmpty) {\n  Object(_borngroup_born_utilities__WEBPACK_IMPORTED_MODULE_0__[\"callbackOnElements\"])(\"[data-pid=\\\"\".concat(currentID, \"\\\"] [data-wishlist-trigger-ready]\"), function (currentTrigger) {\n    updateTriggerState(currentTrigger, isRemove, listIsEmpty);\n  });\n}\n/**\n * Updates the provided `triggerEl` state to reflect a requested server or event change.\n */\n\nfunction updateTriggerState(triggerEl, isRemove, listIsEmpty) {\n  var productContainer = Object(_product_productUtils__WEBPACK_IMPORTED_MODULE_1__[\"getProductContainer\"])(triggerEl),\n      triggerType = getTriggerType(triggerEl),\n      customLabel = '',\n      triggerLabel = '',\n      triggerTitle = '',\n      isCTA = triggerType === 'cta',\n      socialShareEl = document.querySelector('[data-wishlist-component=\"share\"]');\n\n  if (isRemove) {\n    triggerEl.classList.remove('set--in-wishlist');\n    productContainer.classList.remove('set--in-wishlist');\n    productContainer.classList.add('set--removed-wishlist');\n    triggerEl.removeAttribute('data-wishlist-remove');\n    customLabel = triggerEl.getAttribute('data-wishlist-label-add'); //These might differ in the future, so keep separate.\n\n    triggerTitle = customLabel || window.SFRA.Resources.wishlistAdd;\n    triggerLabel = customLabel || window.SFRA.Resources.wishlistAdd;\n  } else {\n    triggerEl.classList.add('set--in-wishlist');\n    productContainer.classList.add('set--in-wishlist');\n    productContainer.classList.remove('set--removed-wishlist');\n    triggerEl.setAttribute('data-wishlist-remove', true);\n    customLabel = triggerEl.getAttribute('data-wishlist-label-remove');\n    triggerTitle = customLabel || window.SFRA.Resources.wishlistRemove;\n    triggerLabel = customLabel || window.SFRA.Resources.wishlistRemove;\n  }\n\n  triggerEl.title = triggerTitle;\n\n  if (isCTA) {\n    var labelTarget = triggerEl.querySelector('[data-wishlist-trigger-component=\"label\"]') || triggerEl;\n    labelTarget.textContent = customLabel || triggerLabel;\n  }\n\n  if (socialShareEl) {\n    if (listIsEmpty) {\n      socialShareEl.classList.add('hidden');\n    } else {\n      socialShareEl.classList.remove('hidden');\n    }\n  }\n}\n/**\n * Gets common Wishlist Trigger data such as PID, selected options, etc.\n */\n\nfunction getTriggerData(triggerEl) {\n  return {\n    isRemove: triggerEl.hasAttribute('data-wishlist-remove'),\n    pid: Object(_product_productUtils__WEBPACK_IMPORTED_MODULE_1__[\"getPidValue\"])(triggerEl),\n    options: Object(_product_productUtils__WEBPACK_IMPORTED_MODULE_1__[\"getOptions\"])(triggerEl)[0] || {}\n  };\n}\n/**\n * Updates the wishlist triggers for a given container.\n */\n\nfunction updateWishlistTriggers(containerEl, isRemove) {\n  var wishlistTriggers = containerEl.querySelectorAll('[data-wishlist-trigger-ready]');\n  [].forEach.call(wishlistTriggers, function (currentTrigger) {\n    return updateTriggerState(currentTrigger, isRemove);\n  });\n}\n\n//# sourceURL=webpack:///./cartridges/app_accelerator_core/cartridge/client/default/js/wishlist/wishlistUtils.js?");

/***/ })

}]);