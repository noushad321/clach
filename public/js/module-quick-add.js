(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["module-quick-add"],{

/***/ "./cartridges/app_accelerator_core/cartridge/client/default/js/modules/module.quick-add.js":
/*!*************************************************************************************************!*\
  !*** ./cartridges/app_accelerator_core/cartridge/client/default/js/modules/module.quick-add.js ***!
  \*************************************************************************************************/
/*! exports provided: requestQuickAdd, setupQuickAddListeners, init */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"requestQuickAdd\", function() { return requestQuickAdd; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setupQuickAddListeners\", function() { return setupQuickAddListeners; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"init\", function() { return init; });\n/* harmony import */ var _borngroup_born_toggle__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @borngroup/born-toggle */ \"./node_modules/@borngroup/born-toggle/dist/born-toggle.min.js\");\n/* harmony import */ var _borngroup_born_toggle__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_borngroup_born_toggle__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _product_variationsUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../product/variationsUtils */ \"./cartridges/app_accelerator_core/cartridge/client/default/js/product/variationsUtils.js\");\n/* harmony import */ var _product_addToCart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../product/addToCart */ \"./cartridges/app_mea_core/cartridge/client/default/js/product/addToCart.js\");\n/* harmony import */ var _product_productUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../product/productUtils */ \"./cartridges/app_accelerator_core/cartridge/client/default/js/product/productUtils.js\");\n/* harmony import */ var _components_progress__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/progress */ \"./cartridges/app_accelerator_core/cartridge/client/default/js/components/progress.js\");\n\n\n // import {callbackOnElements} from '@borngroup/born-utilities';\n\n\n\n\n // import * as lineItem from '../cart/lineItem';\n\nvar PRODUCT_TYPE = 'quickadd';\nvar currentlyActiveQuickAdd;\n\nfunction _renderQuickAddPanel(productContainer, response) {\n  var quickAddPanel = productContainer.querySelector('[data-quickadd-component=\"panel\"]');\n  quickAddPanel.textContent = '';\n  quickAddPanel.insertAdjacentHTML('afterbegin', response.renderedTemplate); //Ensures there's a wait before HTML is inserted.\n\n  document.body.offsetWidth;\n  quickAddPanel.classList.add('set--ready');\n  Object(_product_variationsUtils__WEBPACK_IMPORTED_MODULE_1__[\"setupVariationListeners\"])(quickAddPanel);\n} // function _renderQuickAddActions(currentContainer, response) {\n//     if (!currentContainer.querySelector('[data-quickadd-component=\"actions\"]')) {\n//         currentContainer.insertAdjacentHTML('beforeend', response.renderedActionsTemplate);\n//     }\n// }\n\n\nfunction _handleQuickAddSuccess(currentTrigger, response) {\n  var productContainer = Object(_product_productUtils__WEBPACK_IMPORTED_MODULE_3__[\"getProductContainer\"])(currentTrigger);\n  _components_progress__WEBPACK_IMPORTED_MODULE_4__[\"hideLoader\"]();\n\n  if (response.product.readyToOrder) {\n    // _renderQuickAddActions(_getQuickAddContainer(currentTrigger), response);\n    Object(_product_addToCart__WEBPACK_IMPORTED_MODULE_2__[\"handleCartAdd\"])(productContainer, response.product);\n  } else {\n    _renderQuickAddPanel(productContainer, response);\n  }\n} // function _getQuickAddContainer(el) {\n//     return el.closest('[data-quickadd]');\n// }\n\n\nfunction _onAfterAttributeSelect() {\n  $('body').on('product:afterAttributeSelect.quickAdd', function (evt, response) {\n    if (Object(_product_productUtils__WEBPACK_IMPORTED_MODULE_3__[\"getProductType\"])(response.container) === PRODUCT_TYPE && response.data.product.readyToOrder) {\n      Object(_product_addToCart__WEBPACK_IMPORTED_MODULE_2__[\"handleCartAdd\"])(response.container, response.data.product);\n    }\n  });\n}\n\nfunction _onAfterAddToCart() {\n  $('body').on('product:afterAddToCart.quickAdd', function () {\n    if (currentlyActiveQuickAdd) {\n      // let quickAddContainer = _getQuickAddContainer(currentlyActiveQuickAdd),\n      //     quickAddActions = quickAddContainer.querySelector('[data-quickadd-component=\"actions\"]');\n      // console.log(data);\n      // if (quickAddActions) {\n      //     quickAddActions.setAttribute('data-cart-line-item', data.response.pliUUID);\n      //     lineItem.init(quickAddActions);\n      //     quickAddContainer.classList.add('set--added-to-cart');\n      // }\n      currentlyActiveQuickAdd.toggle.unset();\n    }\n  });\n}\n\nfunction requestQuickAdd(quickAddURL, currentTrigger) {\n  _components_progress__WEBPACK_IMPORTED_MODULE_4__[\"showLoader\"](currentTrigger);\n  $.ajax(quickAddURL, {\n    success: _handleQuickAddSuccess.bind(this, currentTrigger)\n  });\n}\nfunction setupQuickAddListeners() {\n  return new _borngroup_born_toggle__WEBPACK_IMPORTED_MODULE_0___default.a({\n    triggers: '[data-quickadd-trigger]',\n    target: '[data-quickadd-component=\"panel\"]',\n    parent: '[data-product-container]',\n    dataAttribute: 'data-quickadd-trigger',\n    activeClass: 'set--quickadd-active',\n    targetFocus: true,\n    focusTrap: true,\n    beforeSet: function beforeSet(currentTrigger) {\n      currentlyActiveQuickAdd = currentTrigger;\n      requestQuickAdd(currentTrigger.href || currentTrigger.getAttribute('data-url'), currentTrigger);\n      return true;\n    },\n    afterUnset: function afterUnset(currentTrigger) {\n      currentlyActiveQuickAdd = undefined;\n      currentTrigger.toggle.targetEl.classList.remove('set--ready');\n    }\n  });\n}\nfunction init() {\n  setupQuickAddListeners();\n\n  _onAfterAttributeSelect();\n\n  _onAfterAddToCart();\n}\n\n//# sourceURL=webpack:///./cartridges/app_accelerator_core/cartridge/client/default/js/modules/module.quick-add.js?");

/***/ })

}]);